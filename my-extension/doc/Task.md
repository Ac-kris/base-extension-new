# 飞书多维表格插件开发任务清单

## 初始化项目

- [x] 1. 创建项目基本结构（package.json、index.html等）
- [x] 2. 安装必要的依赖（@lark-base-open/js-sdk、React等）
- [x] 3. 配置构建工具（Vite）

## 前端界面开发

- [x] 4. 创建边栏插件UI组件
- [x] 5. 实现原数据表选择下拉框
- [x] 6. 实现月份选择下拉框（1-12月）
- [x] 7. 实现生成按钮及加载状态

## 数据处理功能

- [x] 8. 获取原数据表信息的方法
- [x] 9. 创建新表格的方法
- [x] 10. 创建所需字段的方法
   - [x] 10.1 项目（下拉选择）
   - [x] 10.2 人数（整数数字）
   - [x] 10.3 份数（带2位小数的数字）
   - [x] 10.4 制备费（金额，2位小数）
   - [x] 10.5 出库订单奖励扣减（金额，2位小数）
   - [x] 10.6 制剂取消收取费用（金额，2位小数）
   - [x] 10.7 制剂加急/非正常出库时间收取费用（金额，2位小数）
- [x] 11. 数据筛选和汇总功能
   - [x] 11.1 按月份筛选数据
   - [x] 11.2 按产品类别分组
   - [x] 11.3 计算人数（行数统计）
   - [x] 11.4 计算份数总和
   - [x] 11.5 计算制备费总额
   - [x] 11.6 计算出库订单奖励扣减总额
   - [x] 11.7 计算制剂取消收取费用总额
   - [x] 11.8 计算制剂加急/非正常出库时间收取费用总额
- [x] 12. 数据写入新表格的方法

## 异常处理

- [x] 13. 添加错误处理机制
- [x] 14. 添加加载状态提示
- [x] 15. 添加成功/失败提示

## 测试与优化

- [x] 16. 完整流程测试
- [x] 17. 界面优化
- [x] 18. 性能优化 